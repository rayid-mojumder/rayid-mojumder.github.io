---
layout: default
---

<!-- about.html -->
<div class="post">
  <header class="post-header">
    <h1 class="post-title">
      {% if site.title == "blank" -%}
        <span class="font-weight-bold">{{ site.first_name }}</span> {{ site.middle_name }} {{ site.last_name }}
      {%- else -%}
        {{ site.title }}
      {%- endif %}
    </h1>
    <p class="desc">{{ page.subtitle }}</p>
  </header>

  <article>
    {% if page.profile -%}
    <div class="profile float-{%- if page.profile.align == 'left' -%}left{%- else -%}right{%- endif -%}">
      {%- if page.profile.image %}
        {%- assign profile_image_path = page.profile.image | prepend: 'assets/img/' -%}

        {% if page.profile.image_circular %}
          {%- assign profile_image_class = "img-fluid z-depth-1 rounded-circle" -%}
        {% else %}
          {%- assign profile_image_class = "img-fluid z-depth-1 rounded" -%}
        {% endif %}

        {% capture sizes %}(min-width: {{site.max_width}}) {{ site.max_width | minus: 30 | times: 0.3}}px, (min-width: 576px) 30vw, 95vw"{% endcapture %}

        {% include figure.html
          path = profile_image_path
          class = profile_image_class
          sizes = sizes
          alt = page.profile.image
          cache_bust = true 
        %}
      {% endif -%}
      {%- if page.profile.more_info %}
      <div class="more-info">
        {{ page.profile.more_info }}
      </div>
      {%- endif %}
    </div>
    {%- endif %}

    <div class="clearfix">
      {{ content }}
    </div>

    <!-- News -->
    {% if page.news and site.announcements.enabled -%}
      <h2><a href="{{ '/news/' | relative_url }}" style="color: inherit;">news</a></h2>
      {%- include news.html limit=true %}
    {% endif -%}

    <!-- Latest posts -->
    {% if page.latest_posts -%}
      <h2><a href="{{ '/blog/' | relative_url }}" style="color: inherit;">latest posts</a></h2>
      {%- include latest_posts.html %}
    {% endif -%}

    <!-- Selected papers -->
    {% if page.selected_papers -%}
      <h2><a href="{{ '/publications/' | relative_url }}" style="color: inherit;">selected publications</a></h2>
      {%- include selected_papers.html %}
    {% endif -%}

    <!-- Social -->
    {% if page.social %}
      <div class="social">
        <div class="contact-icons">
          {% include social.html %}
        </div>
        <div class="contact-note">
          {{ site.contact_note }}
        </div>
      </div>
    {% endif %}

    <!-- ============================ -->
    <!--     ANALYTICS WIDGET START  -->
    <!-- ============================ -->
    <div id="analytics" style="border: 1px solid #ccc; padding: 1rem; margin-top: 2rem; max-width: 700px;">
      <h2 style="margin-top: 0;">Site Analytics</h2>
      <p>Total Views: <span id="total-views">Loading...</span></p>
      <p>Today's Views: <span id="today-views">Loading...</span></p>
      <div id="world-map"></div>
      <p id="analytics-error" style="color:red;"></p>
    </div>
  </article>
</div>

<!-- 1) jQuery -->
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>

<!-- 2) jVectorMap CSS & JS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jvectormap@2.0.5/jquery-jvectormap.css">
<script src="https://cdn.jsdelivr.net/npm/jvectormap@2.0.5/jquery-jvectormap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jvectormap@2.0.5/tests/assets/jquery-jvectormap-world-mill-en.js"></script>

<!-- 3) Basic styling for the map container -->
<style>
  #world-map {
    width: 600px;
    height: 400px;
    margin-top: 20px;
  }
</style>

<!-- 4) Main Analytics Script -->
<script>
(async function() {
  // If page is not served over HTTPS, show a warning
  if (location.protocol !== 'https:') {
    document.getElementById('analytics-error').textContent =
      'Warning: This page is not served over HTTPS. Some requests may fail.';
    console.warn('Warning: This page is not served over HTTPS. Some requests may fail.');
  }

  // Random unique namespace - do not change
  const namespace = 'rayidmojumder-unique-namespace-23987';

  // Attempt geolocation from ipapi.co, then fallback to ipwho.is
  async function getGeoData() {
    try {
      const res = await fetch('https://ipapi.co/json/');
      if (!res.ok) throw new Error('ipapi.co request failed: ' + res.status);
      return await res.json();
    } catch (err) {
      console.warn('ipapi.co failed, trying fallback to ipwho.is', err);
      const res2 = await fetch('https://ipwho.is/');
      if (!res2.ok) throw new Error('ipwho.is request failed: ' + res2.status);
      return await res2.json();
    }
  }

  // Update total views
  async function updateTotalViews() {
    try {
      const res = await fetch(`https://api.countapi.xyz/hit/${namespace}/total`);
      if (!res.ok) throw new Error('CountAPI total request failed: ' + res.status);
      const data = await res.json();
      document.getElementById('total-views').innerText = data.value;
    } catch (err) {
      console.error('Error updating total views:', err);
      document.getElementById('analytics-error').textContent =
        'Error: Unable to update total views.';
    }
  }

  // Update today's views
  async function updateTodayViews() {
    try {
      const today = new Date().toISOString().slice(0,10);
      const res = await fetch(`https://api.countapi.xyz/hit/${namespace}/${today}`);
      if (!res.ok) throw new Error('CountAPI daily request failed: ' + res.status);
      const data = await res.json();
      document.getElementById('today-views').innerText = data.value;
    } catch (err) {
      console.error('Error updating today views:', err);
      document.getElementById('analytics-error').textContent =
        'Error: Unable to update today views.';
    }
  }

  // Per-country view counts
  let countryViews = {};

  // Helper to update map data
  function updateMapData(countryCode, views) {
    // jVectorMap expects lowercase ISO codes
    countryViews[countryCode.toLowerCase()] = views;
    if ($('#world-map').data('mapObject')) {
      $('#world-map').vectorMap('set', 'values', countryViews);
    }
  }

  // Initialize the world map
  $(function() {
    $('#world-map').vectorMap({
      map: 'world_mill_en',
      series: {
        regions: [{
          values: countryViews,
          scale: ['#C8EEFF', '#0071A4'],
          normalizeFunction: 'linear'
        }]
      },
      onRegionTipShow: function(e, el, code) {
        if (countryViews[code]) {
          el.html(
